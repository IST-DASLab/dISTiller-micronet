version: 1
pruners:
  low_pruner:
    class: AutomatedGradualPruner
    initial_sparsity : 0.05
    final_sparsity: 0.60
    weights: [module.layer2.0.conv2.weight,
              module.layer3.1.conv1.weight,  module.layer3.1.conv2.weight,
              module.layer4.0.conv1.weight,  module.layer4.0.conv2.weight, module.layer4.0.downsample.0.weight,
              module.layer4.1.conv1.weight]

  mid_pruner:
    class:  AutomatedGradualPruner
    initial_sparsity : 0.05
    final_sparsity: 0.67
    weights: [module.layer1.1.conv1.weight,  module.layer1.1.conv2.weight,
              module.layer2.0.conv1.weight,  module.layer2.0.downsample.0.weight,
              module.layer3.0.conv2.weight,  module.layer4.1.conv2.weight]

  high_pruner:
    class:  AutomatedGradualPruner
    initial_sparsity : 0.05
    final_sparsity: 0.76
    weights: [module.layer1.0.conv1.weight,  module.layer1.0.conv2.weight,
              module.layer2.1.conv1.weight,  module.layer2.1.conv2.weight,
              module.layer3.0.conv1.weight]

lr_schedulers:
   pruning_lr:
     class: ExponentialLR
     gamma: 0.9


policies:
  - pruner:
      instance_name : low_pruner
    starting_epoch: 0
    ending_epoch: 16
    frequency: 2

  - pruner:
      instance_name : mid_pruner
    starting_epoch: 4
    ending_epoch: 16
    frequency: 2

  - pruner:
      instance_name : high_pruner
    starting_epoch: 4
    ending_epoch: 16
    frequency: 2

  - lr_scheduler:
      instance_name: pruning_lr
    starting_epoch: 13
    ending_epoch: 100
    frequency: 1